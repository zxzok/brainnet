{% extends "base.html" %}

{% block title %}Network Visualization - BrainNet MRI Data Management{% endblock %}

{% block content %}
<div class="container my-4">
    <h2>Brain Network Visualization</h2>
    <p>This page displays the computed brain network and its dynamic features.</p>
    <div class="row mb-4">
        <div class="col-md-8">
            <div id="cy" style="width: 100%; height: 500px; border: 1px solid #ccc;"></div>
        </div>
        <div class="col-md-4">
            <h5>Network Dynamic Features</h5>
            <canvas id="featureChart" width="400" height="400"></canvas>
        </div>
    </div>
</div>

<!-- Include Cytoscape.js for network visualization -->
<script src="https://unpkg.com/cytoscape@3.21.1/dist/cytoscape.min.js"></script>
<!-- Include Chart.js for dynamic features -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// Load network data from the API
fetch("{{ url_for('api_network_data') }}")
    .then(response => response.json())
    .then(data => {
        // Initialize Cytoscape with fetched data
        var cy = cytoscape({
            container: document.getElementById('cy'),
            elements: data.elements,
            style: [
                {
                    selector: 'node',
                    style: {
                        'background-color': '#007bff',
                        'label': 'data(label)',
                        'color': '#fff',
                        'text-valign': 'center',
                        'text-halign': 'center'
                    }
                },
                {
                    selector: 'edge',
                    style: {
                        'width': 2,
                        'line-color': '#ccc'
                    }
                }
            ],
            layout: {
                name: 'cose'
            }
        });
    });

// Example dynamic features chart using Chart.js
const ctx = document.getElementById('featureChart').getContext('2d');
const featureChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: ['Time 1', 'Time 2', 'Time 3', 'Time 4', 'Time 5'],
        datasets: [{
            label: 'Network Feature 1',
            data: [5, 6, 7, 8, 7],
            borderColor: 'rgba(255, 99, 132, 1)',
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
            fill: true
        }, {
            label: 'Network Feature 2',
            data: [3, 4, 3, 5, 6],
            borderColor: 'rgba(54, 162, 235, 1)',
            backgroundColor: 'rgba(54, 162, 235, 0.2)',
            fill: true
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: { beginAtZero: true }
        }
    }
});
</script>

{% endblock %}
